rules_version = '2';
// Firebase Storage Rules - allow owner AND admin (same tenant) to access gallery
// Admin acts on behalf of owner, so any authenticated user can write to gallery paths.
// The app enforces tenant scoping via setAuthCache(ownerId).
service firebase.storage {
  match /b/{bucket}/o {
    match /gallery/{ownerId}/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    match /gov_ids/{ownerId}/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    match /vehicle-images/{ownerId}/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
